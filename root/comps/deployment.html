<section id="deployment">
  <h2>Deployment</h2>
  <p>
    Go4lage comes ready to ship. The recommended way is to run it with docker
    and have one native entrance NGINX instance running that you use for SSL.
  </p>
  <p>
    If you go this recommend route, the whole process will take 1-3 hours max as
    you only need to setup your domian, native NGINX and SSL
  </p>
  <p>
    (You might have noticed that there is no extra slow dev server. Only a
    native version for heavy deployment) Go is just compiling so fast, that no
    extra dev server is needed.
  </p>
  <p>
    The go4lage packacke consists of a POSTGRES db, the Go4lage app, and 2
    volumes. One for the database and one for dynamic media.
  </p>

  <div style="display: flex; justify-content: center; margin: 25px">
    <img width="650px" src="pics/deploy.png" alt="deployment" />
  </div>

  <p>
    The native NGINX should handle the SSL encription. It is recommended to use
    <a href="https://certbot.eff.org" alt="Link to certbot"><b>certbot</b></a>
    for ssl. it is very good and free of charge.
  </p>
  <p>Basic access logging is also already included in Go4lage.</p>


<pre><code>#!/bin/bash
    git clone https://github.com/Karl1b/go4lage.git
    cd go4lage
    cp prodenv.env .env
    # Adjust the .env
    docker-compose up -d
    docker-compose exec app /app/go4lage createsuperuser
</code></pre>

<p>
  This is an example config for your native nginx RP:
</p>

  <pre><code>#/etc/nginx/sites-available/subdomain.domain.com

    server {
      server_name subdomain.domain.com
  
      client_max_body_size 10M;
  
      location / {
          proxy_pass http://127.0.0.1:8080;
          proxy_set_header Host $host;
          proxy_set_header X-Real-IP $remote_addr;
          proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
          proxy_set_header X-Forwarded-Proto $scheme;
      }
  
      # listen 443 ssl; # managed by Certbot
      # ssl_certificate  # managed by Certbot
      # ssl_certificate # managed by Certbot
      include /etc/letsencrypt/options-ssl-nginx.conf; # managed by Certbot
      ssl_dhparam /etc/letsencrypt/ssl-dhparams.pem; # managed by Certbot
    }
  
    server {
      if ($host = subdomain.domain.com) {
          return 301 https://$host$request_uri;
      } # managed by Certbot
  
      listen 80;
      server_name subdomain.domain.com;
      return 404; # managed by Certbot
    }
    </code></pre>



</section>
